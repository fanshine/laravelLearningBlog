<html>

	<head>
	    <meta charset="utf-8">
	    <title>
	    	 首页 -  Laravel 知识整理
	    </title>
	    <meta name="description" content=" (Fanshine)">
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
		<link rel="stylesheet" href="/theme/styles/styles.css">
		<link rel="stylesheet" href="/theme/styles/pygments.css">
		<link rel="stylesheet" href="/theme/styles/my.css">

		<script type="text/javascript" src="/js/jquery/jquery-1.8.0.min.js"></script>
		<script type="text/javascript">
			$(function(){

			});
		</script>

	</head>

	<body>
		<div id="wrapper">

			<div id="header">
				<ul id="extras-nav">
					<li><a href="/">博客</a></li>
					<li><a href="/archives.html">存档</a></li>
					<li><a href="/about.html">关于</a></li>
					<li><a href="/atom.xml" target="_blank" rel="nofollow">RSS</a></li>
				</ul>
				<h1><a id="title" href="/">Laravel 知识整理</a></h1>
			</div>


			<div id="content">
    <div class="text-post posts">

	
		
		<h2><a class="post_title" href="/2014-08-11/getting-started-with-laravel-4.html">开始使用Laravel4</a></h2>
		
		<div class="caption rich-content">
			<p><a href="https://github.com/laravel/framework">Laravel 4</a> 是流行的PHP框架<a href="http://laravel.com/">Laravel</a>的一个最新升级版本。Laravel是一个“干净优雅”的用于Web开发的现代PHP框架。受<a href="http://rubyonrails.org/">Ruby on Rails</a>，以及<a href="http://symfony.com/">Symfony</a>框架的启发，Laravel 4致力于让你使用近年来日益完善的PHP新技术来开发好的web程序。</p>

<p>Laravel 4脱胎于<a href="http://laravel.com">Laravel 3</a>，但是对上一个版本又做了很多的改进。现在，Laravel 4是一个经过了大量测试，并且在维持干净优雅的语法结构的基础上，继续添加新的组件和特性的框架。</p>

<p>Laravel 4通过<a href="http://getcomposer.org/">Composer</a>来管理更新和独立的第三方组件</p>

		</div>

	
		
		<h2><a class="post_title" href="/2013-04-15/no-branches-ready-for-upload.html">no branches ready for upload</a></h2>
		
		<div class="caption rich-content">
			<p>You must do the following steps:</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>repo abandon &lt;branch&gt; &lt;project&gt;
<span class="nv">$ </span>repo start &lt;branch&gt; &lt;project&gt;
<span class="nv">$ </span>git reset --hard &lt;latest-github-commit-id&gt;
  <span class="o">(</span>git add/commit<span class="o">)</span>
<span class="nv">$ </span>repo upload &lt;project&gt;</code></pre></div>




		</div>

	
		
		<h2><a class="post_title" href="/2012-12-10/custom-manifest-with-maven.html">使用Maven定制MANIFEST.MF文件</a></h2>
		
		<div class="caption rich-content">
			<p>对于Java开发者来说，对MANIFEST.MF文件应该不陌生，至少有所耳闻。我们打开任何一个jar包，都会看到一个METE-INF目录，该目录下必然有一个MANIFEST.MF文件，这个文件是用来描述当前jar文件的信息。</p>

<p>举个例子，下面是我们常使用的c3p0-0.9.1.2.jar文件里的MANIFEST.MF内容：</p>

<blockquote><p>Manifest-Version: 1.0<br/>
  Ant-Version: Apache Ant 1.7.0<br/>
  Created-By: 1.5.0_07-87 ("Apple Computer, Inc.")<br/>
  Extension-Name: com.mchange.v2.c3p0<br/>
  Specification-Vendor: Machinery For Change, Inc.<br/>
  Specification-Version: 1.0<br/>
  Implementation-Vendor-Id: com.mchange<br/>
  Implementation-Vendor: Machinery For Change, Inc.<br/>
  Implementation-Version: 0.9.1.2</p></blockquote>

<p>它看起来简单明了，我就不多解释了。当然，不同的jar包里的内容可能完全不同，比如说Springframwork的那些jar文件，内容不但多了许多，而且名称也都变得不同。</p>

<p>我曾经参与的一个Web项目中，有一个需求是在页面某个位置显示代码构建的时间，看起来差不多是这样的：</p>

<blockquote><p>Build At: 2012-12-10 23:54:22</p></blockquote>

<p>（当时的情况还要求显示代码的版本号，具体做法本文先略过。）</p>

<p>当时就是采用定制MANIFEST.MF（加入构建时间戳），并用程序读取该时间戳实现的！
接下来就结合该需求说说在使用Maven构建的项目中，如何为MANIFEST.MF增加自定义内容，并完成该功能。</p>

<ol>
<li><p>首先，在pom.xml文件中增加属性：</p>

<blockquote><p>&lt;properties&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;maven.build.timestamp.format>yyyy-MM-dd HH:mm:ss&lt;/maven.build.timestamp.format&gt;<br/>
&lt;/properties&gt;</p></blockquote></li>
<li><p>接下来配置maven-war-plugin插件，在configuration里增加archive节点，配置如下：</p>

<blockquote><p>&lt;plugin&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;2.1.1&lt;/version&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;configuration&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;archive&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;manifest&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;addDefaultSpecificationEntries&gt;true&lt;/addDefaultSpecificationEntries&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/manifest&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;manifestEntries&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Built-At&gt;${maven.build.timestamp}&lt;/Built-At&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/manifestEntries&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/archive&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/configuration&gt;<br/>
&lt;/plugin&gt;</p></blockquote></li>
<li><p>这样，当你再次打包工程时，新打包的文件里的MANIFEST.MF就会包含构建时间，如图：<br/>
<img src="../uploads/2012-12-10/manifest.mf.png" alt="MANIFEST.MF" /><br/>
PS：你还可以增加更多内容，只需要在manifestEntries节点中增加key-value值就OK啦。</p></li>
<li><p>最后一步：你需要写一小段代码来获取该构件时间，把它显示在你的页面上。<br/>
或许你已经知道大名鼎鼎的框架Springframework获取版本号的代码是这样的(详见<a href="https://github.com/SpringSource/spring-framework/blob/3.1.x/org.springframework.core/src/main/java/org/springframework/core/SpringVersion.java">SpringVersion.java</a>)：</p></li>
</ol>


<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getVersion</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Package</span> <span class="n">pkg</span> <span class="o">=</span> <span class="n">SpringVersion</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getPackage</span><span class="o">();</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">pkg</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">pkg</span><span class="o">.</span><span class="na">getImplementationVersion</span><span class="o">()</span> <span class="o">:</span> <span class="kc">null</span><span class="o">);</span>
<span class="o">}</span></code></pre></div>


<p>但很遗憾这种方式在Web项目中不起作用。因为为Web应用编写的Java代码，会编译为class文件并放在$WEBROOT/WEB-INF/classes目录下，而war包的MANIFEST.MF文件位于$WEBROOT/META-INF目录下，它们不在同一个“包”下。事实上，Package类根本没有提供任何获取自定义值的方法（哈哈哈），详见<a href="http://www.oschina.net/uploads/doc/javase-6-doc-api-zh_CN/java/lang/Package.html">Package.html</a>。<br/>
所以 --- 是时候自己动手了。</p>

		</div>

	
		
		<h2><a class="post_title" href="/2012-12-06/development-webapp-in-idea.html">使用Idea社区版开发Web项目</a></h2>
		
		<div class="caption rich-content">
			<p>在很久很久以前，就听说<a href="http://www.jetbrains.com/idea/">IDEA</a>是个绝佳的Java开发工具，奈何囊中羞涩，个人对付费软件只能望而却步；一直善良老实的我，也不好意思去CRACK。所以一直都是使用开源免费的<a href="http://www.eclipse.org/">Eclipse</a>作为工作和学习的IDE。
其实以前也尝试使用过社区版，心里总觉得嘛，功能不全，试试而已，然后就搁下了，所以它一直只是我桌面上的一个的图标而已。。。</p>

<p>但是<a href="http://www.jetbrains.com/idea/">IDEA</a>绝不是鸡肋！它已经有很多优秀的功能（只会用小部分功能，待挖掘。。。目前感觉很快，够敏捷，:-)），完全值得我们去尝试，相信很多<a href="http://www.eclipse.org/">Eclipse</a>使用者，特别是Eclipse EE版的使用者，可能会嫌弃它没有Web开发功能，但事实上我们也可以用它来开发Web项目的。</p>

<p>下面会来证明这一点，我会用<a href="http://www.jetbrains.com/idea/">IDEA</a> + <a href="http://maven.apache.org/">Maven</a> + <a href="http://jetty.codehaus.org/jetty/">Jetty</a>来开发Web项目，主要演示下如何调试代码。<br/>
（真希望你对<a href="http://maven.apache.org/">Maven</a>不陌生，否则花一点时间去学习一下吧，你会喜欢它的。）</p>

<ol>
<li><p>首先我们来创建一个<a href="http://maven.apache.org/">Maven</a>项目，项目类型选择“Maven Module”，输入项目名称“demo”。<br/>
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-12-06/222828_JrZA_80532.png" alt="创建项目-项目类型" /></p></li>
<li><p>选择项目使用的Archetype为“maven-archetype-webapp”，这里也可以随便修改下GroupId等信息。<br/>
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-12-06/222904_DxyX_80532.png" alt="创建项目-Archetype" /></p></li>
<li><p>这一步直接点击“Finish”。<br/>
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-12-06/223024_yV3j_80532.png" alt="创建项目-属性" /></p></li>
<li><p>打开<a href="http://maven.apache.org/">Maven</a>的配置文件pom.xml，在build节点中添加如下代码，即增加Maven的<a href="http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin">Jetty插件</a>。</p>

<blockquote><p>&lt;plugins&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;plugin&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;maven-jetty-plugin&lt;/artifactId&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;6.1.26&lt;/version&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;configuration&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;connectors&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;connector implementation="org.mortbay.jetty.nio.SelectChannelConnector"&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;port&gt;8080&lt;/port&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/connector&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/connectors&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;scanIntervalSeconds&gt;10&lt;/scanIntervalSeconds&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/plugin&gt;<br/>
&lt;/plugins&gt;</p></blockquote></li>
<li><p>选择工具栏的"Run"-->"Edit Configurations..."，打开“Run/Debug Configurations”窗口，点击绿色的“+”号按钮，在弹出的下拉列表里选择“Maven”。
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-12-06/223812_yM8Q_80532.png" alt="配置运行/调试-增加" /></p></li>
<li><p>取一个名称，比如“demo-jetty”；在"Working directory"一栏选择你的工作目录，并在"Command Line"里输入“jetty:run”。然后点击“OK”。<br/>
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-12-06/223909_KTqX_80532.png" alt="配置运行/调试-Maven" /></p></li>
<li><p>到此，配置已经OK了，在工具栏上出现了一个名为“demo-jetty”的运行项，点击后面的调试按钮就可以进行调试了。<br/>
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-12-06/223947_wYLs_80532.png" alt="配置运行/调试-Maven" /></p></li>
</ol>


<p>当然，Web开发还有很多方面啦，这篇仅仅是演示了如何使用<a href="http://www.jetbrains.com/idea/">IDEA</a>结合<a href="http://maven.apache.org/">Maven</a>来开发（着重调试）Web项目。路漫漫其修远兮，吾将上下而求索，我也是初步来尝试<a href="http://www.jetbrains.com/idea/">IDEA</a>，希望以后可以把它用好！！</p>

		</div>

	
		
		<h2><a class="post_title" href="/2012-10-19/hello-lucene.html">Lucene简介和入门</a></h2>
		
		<div class="caption rich-content">
			<p>这几天我花了些时间去研究了下Lucene，读了很多博客和文章，也写了些示例代码，对全文检索以及使用到的技术都有了认识，感觉非常好。<br/>
Lucene是当今非常流行的全文检索工具，对于我们开发者来说，给应用添加一个搜索功能确实容易很多了，希望在接下来的项目里可以一施拳脚。<br/>
接下来对Lucene进行一个初步的介绍，并附带一个简单的示例程序。</p>

<h3>Lucene 简介</h3>

<p>Lucene是一个基于Java的高性能、可伸缩的全文信息检索库，它提供了简单而强大的API，让你很容易为文档创建索引，并基于创建的索引进行搜索。<br/>
Lucene是由资深全文索引/检索专家Doug Cutting创建的，开始是给自己的博客程序使用，后来开源出来，如今它已成为Apache软件基金会的顶级项目，也成为最受欢迎的Java全文信息检索工具。</p>

<h3>Lucene 原理</h3>

<p>Lucene主要完成两件事：</p>

<ol>
<li>创建索引</li>
<li>基于索引搜索。</li>
</ol>


<p>创建搜索是一件非常关键的一步，Lucene 采用的是一种称为反向索引（inverted index）的机制。
先说下什么是正向索引（若是有这个概念的话），给你一些文档，让你找到里面的词/短语，类似小学课堂上，老说问：“同学们，有谁来总结下这篇文章讲了什么？”，这是一个从文档到词/短语的过程。<br/>
而反向索引刚好相反，它是指从词/短语到文档的过程，举一个例子：给出“Java”这个关键字，找到所有Java相关的文档。</p>

<p>当索引创建已经创建好之后，搜索文档就是先到索引库里去找索引，然后根据找到的索引找到文档。整个过程可以用下图表示：
<img src="http://fanshine.github.io/laravelLearningBlog//uploads/2012-10-19/lucene.png" alt="Lucene典型应用结构图" /></p>

<h3>入门示例</h3>

<p><strong>创建索引</strong></p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">index</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">docsDir</span> <span class="o">=</span> <span class="s">&quot;src&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">indexDir</span> <span class="o">=</span> <span class="s">&quot;target/index&quot;</span><span class="o">;</span>
        <span class="n">Directory</span> <span class="n">directory</span> <span class="o">=</span> <span class="n">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">indexDir</span><span class="o">));</span>
        <span class="n">Analyzer</span> <span class="n">analyzer</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">StandardAnalyzer</span><span class="o">(</span><span class="n">Version</span><span class="o">.</span><span class="na">LUCENE_40</span><span class="o">);</span>
        <span class="n">IndexWriterConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">IndexWriterConfig</span><span class="o">(</span><span class="n">Version</span><span class="o">.</span><span class="na">LUCENE_40</span><span class="o">,</span> <span class="n">analyzer</span><span class="o">);</span>
        <span class="n">IndexWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">IndexWriter</span><span class="o">(</span><span class="n">directory</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>
        <span class="n">indexDocs</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">docsDir</span><span class="o">));</span>
        <span class="n">writer</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">indexDocs</span><span class="o">(</span><span class="n">IndexWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">File</span> <span class="n">path</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">path</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">File</span><span class="o">[]</span> <span class="n">files</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">listFiles</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">files</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">files</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">indexDocs</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">files</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">Document</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Document</span><span class="o">();</span>
        <span class="n">doc</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nf">StringField</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">path</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">));</span>
        <span class="n">doc</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nf">StringField</span><span class="o">(</span><span class="s">&quot;path&quot;</span><span class="o">,</span> <span class="n">path</span><span class="o">.</span><span class="na">getPath</span><span class="o">(),</span> <span class="n">Field</span><span class="o">.</span><span class="na">Store</span><span class="o">.</span><span class="na">YES</span><span class="o">));</span>
        <span class="n">doc</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nf">TextField</span><span class="o">(</span><span class="s">&quot;contents&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">FileReader</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;adding &quot;</span> <span class="o">+</span> <span class="n">path</span><span class="o">);</span>
        <span class="n">writer</span><span class="o">.</span><span class="na">addDocument</span><span class="o">(</span><span class="n">doc</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>


<p><strong>基于索引搜索</strong></p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">search</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">index</span> <span class="o">=</span> <span class="s">&quot;target/index&quot;</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">searchField</span> <span class="o">=</span> <span class="s">&quot;contents&quot;</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">keyWorld</span> <span class="o">=</span> <span class="s">&quot;String&quot;</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">IndexReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">DirectoryReader</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">FSDirectory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">index</span><span class="o">)));</span>
        <span class="n">IndexSearcher</span> <span class="n">searcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">IndexSearcher</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span>
        <span class="n">Analyzer</span> <span class="n">analyzer</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">StandardAnalyzer</span><span class="o">(</span><span class="n">Version</span><span class="o">.</span><span class="na">LUCENE_40</span><span class="o">);</span>
        <span class="n">QueryParser</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">QueryParser</span><span class="o">(</span><span class="n">Version</span><span class="o">.</span><span class="na">LUCENE_40</span><span class="o">,</span> <span class="n">searchField</span><span class="o">,</span> <span class="n">analyzer</span><span class="o">);</span>
        <span class="n">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">keyWorld</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Search [&quot;</span> <span class="o">+</span> <span class="n">keyWorld</span> <span class="o">+</span> <span class="s">&quot;]:&quot;</span><span class="o">);</span>
        <span class="n">TopDocs</span> <span class="n">results</span> <span class="o">=</span> <span class="n">searcher</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
        <span class="n">ScoreDoc</span><span class="o">[]</span> <span class="n">hits</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="na">scoreDocs</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">hits</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">Document</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">searcher</span><span class="o">.</span><span class="na">doc</span><span class="o">(</span><span class="n">hits</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">doc</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">doc</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">reader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>


<p>项目基于Maven，完整源码请点击下载：<a href="http://fanshine.github.io/laravelLearningBlog//uploads/2012-10-19/lucene.zip" title="lucene.zip">lucene.zip</a></p>

		</div>

	

    </div>
</div>


			<div id="footer">

				<div class="tag-search" style="display: none;">
					<form id="tag-form" action="/tag" method="get">
						<div class="search-text-wrapper">
							<input type="hidden" name="search" value="1">
							<input id="search-text" autocomplete="off" name="tag" class="search-text" type="text" value="">
							<label id="search-tip" style="display: block; ">搜索</label>
							<input id="search-btn" class="search-button" type="button" value="搜索">
						</div>
					</form>
				</div>

				<p>© 2012 Laravel 知识整理</p>
				<p>Powered by <a href="http://www.github.com" target="_blank">Github</a> and <a href="https://github.com/mojombo/jekyll" target="_blank">Jekyll</a> .</p>

			</div>
		</div>

	</body>
</html>